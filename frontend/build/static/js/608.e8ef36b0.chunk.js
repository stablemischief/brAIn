"use strict";(self.webpackChunkbrain_dashboard=self.webpackChunkbrain_dashboard||[]).push([[608],{7608:(e,t,a)=>{a.r(t),a.d(t,{default:()=>X});var s=a(5043),r=a(7550),l=a(1252),i=a(3315),d=a(2683),n=a(7012),o=a(5989),c=a(9399),x=a(9379),m=a(7304),g=a(6058),h=(a(5675),a(9988)),u=a(6252),y=a(8200),p=a(7988),b=a(4239),j=a(9278),f=a(579);m.t1.register(m.PP,m.kc,m.FN,m.No,m.E8,m.hE,m.m_,m.s$,m.UA,m.dN);const k=e=>{var t;let{data:a,chartType:r="line",timeframe:l,className:d="",showControls:n=!0}=e;const[o,c]=s.useState(r),[m,k]=s.useState("cost"),v=(0,s.useMemo)(()=>{if(!a||0===a.length)return{trend:"stable",trendPercentage:0,averageCost:0,totalCost:0,peakDay:null,lowestDay:null};const e=a.reduce((e,t)=>e+t.cost,0),t=e/a.length,s=a.reduce((e,t)=>t.cost>((null===e||void 0===e?void 0:e.cost)||0)?t:e,a[0]),r=a.reduce((e,t)=>t.cost<((null===e||void 0===e?void 0:e.cost)||1/0)?t:e,a[0]);let l="stable",i=0;if(a.length>=2){const e=a.slice(0,Math.floor(a.length/2)),t=a.slice(Math.floor(a.length/2)),s=e.reduce((e,t)=>e+t.cost,0)/e.length,r=t.reduce((e,t)=>e+t.cost,0)/t.length;Math.abs(r-s)>.01&&(l=r>s?"increasing":"decreasing",i=Math.abs((r-s)/s*100))}return{trend:l,trendPercentage:i,averageCost:t,totalCost:e,peakDay:s,lowestDay:r}},[a]),N=(0,s.useMemo)(()=>({labels:a.map(e=>e.date),datasets:[{label:"cost"===m?"Cost ($)":"tokens"===m?"Tokens":"Requests",data:a.map(e=>{switch(m){case"tokens":return e.tokens;case"requests":return e.requests;default:return e.cost}}),borderColor:"rgb(59, 130, 246)",backgroundColor:"area"===o?"rgba(59, 130, 246, 0.1)":"rgba(59, 130, 246, 0.8)",tension:.4,fill:"area"===o,pointHoverRadius:8,pointHoverBackgroundColor:"rgb(59, 130, 246)",pointHoverBorderColor:"rgb(255, 255, 255)",pointHoverBorderWidth:2}]}),[a,m,o]),w=(0,s.useMemo)(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top",labels:{color:"rgb(107, 114, 128)",usePointStyle:!0,pointStyle:"circle"}},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(17, 24, 39, 0.95)",titleColor:"rgb(243, 244, 246)",bodyColor:"rgb(209, 213, 219)",borderColor:"rgb(75, 85, 99)",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:e=>{const t=e.parsed.y;switch(m){case"cost":return"".concat(e.dataset.label,": $").concat(t.toFixed(4));case"tokens":return"".concat(e.dataset.label,": ").concat(t.toLocaleString());default:return"".concat(e.dataset.label,": ").concat(t)}},labelColor:()=>({borderColor:"rgb(59, 130, 246)",backgroundColor:"rgb(59, 130, 246)"})}}},scales:{x:{type:"category",grid:{color:"rgba(107, 114, 128, 0.1)",drawBorder:!1},ticks:{color:"rgb(107, 114, 128)",callback:function(e,t){var s;const r=null===(s=a[t])||void 0===s?void 0:s.date;return r?(0,h.GP)((0,u.H)(r),"MMM dd"):""},maxTicksLimit:8}},y:{beginAtZero:!0,grid:{color:"rgba(107, 114, 128, 0.1)",drawBorder:!1},ticks:{color:"rgb(107, 114, 128)",callback:function(e){switch(m){case"cost":return"$".concat(e.toFixed(2));case"tokens":return"".concat((e/1e3).toFixed(0),"K");default:return e.toString()}}}}},interaction:{mode:"nearest",axis:"x",intersect:!1},animation:{duration:1e3,easing:"easeInOutQuart"}}),[a,m]),_=[{value:"line",label:"Line",icon:y.A},{value:"area",label:"Area",icon:p.A},{value:"bar",label:"Bar",icon:i.A}];return a&&0!==a.length?(0,f.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 ".concat(d),children:[(0,f.jsxs)("div",{className:"p-6 pb-0",children:[(0,f.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Cost Trends"}),(0,f.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"7d"===l?"Last 7 days":"30d"===l?"Last 30 days":"Last 90 days"})]}),n&&(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[{value:"cost",label:"Cost ($)",color:"text-blue-600"},{value:"tokens",label:"Tokens",color:"text-green-600"},{value:"requests",label:"Requests",color:"text-purple-600"}].map(e=>(0,f.jsx)("button",{onClick:()=>k(e.value),className:"px-3 py-1 rounded-md text-xs font-medium transition-colors ".concat(m===e.value?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"),children:e.label},e.value))}),(0,f.jsx)("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:_.map(e=>{const t=e.icon;return(0,f.jsx)("button",{onClick:()=>c(e.value),className:"p-2 rounded-md transition-colors ".concat(o===e.value?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"),title:e.label,children:(0,f.jsx)(t,{className:"h-4 w-4"})},e.value)})})]})]}),(0,f.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6",children:[(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Total"}),(0,f.jsxs)("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["$",v.totalCost.toFixed(2)]})]}),(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Average"}),(0,f.jsxs)("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["$",v.averageCost.toFixed(2)]})]}),(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Peak Day"}),(0,f.jsxs)("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["$",(null===(t=v.peakDay)||void 0===t?void 0:t.cost.toFixed(2))||"0.00"]})]}),(0,f.jsx)("div",{className:"text-center flex items-center justify-center",children:(0,f.jsxs)("div",{className:"flex items-center gap-1",children:["increasing"===v.trend?(0,f.jsx)(b.A,{className:"h-4 w-4 text-red-500"}):"decreasing"===v.trend?(0,f.jsx)(j.A,{className:"h-4 w-4 text-green-500"}):null,(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Trend"}),(0,f.jsx)("p",{className:"text-lg font-semibold ".concat("increasing"===v.trend?"text-red-600 dark:text-red-400":"decreasing"===v.trend?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-400"),children:v.trendPercentage>0?"".concat(v.trendPercentage.toFixed(1),"%"):"Stable"})]})]})})]})]}),(0,f.jsx)("div",{className:"p-6 pt-4",children:(0,f.jsx)("div",{className:"h-[300px]",children:(()=>{const e={data:N,options:w,height:300};return"bar"===o?(0,f.jsx)(g.yP,(0,x.A)({},e)):(0,f.jsx)(g.N1,(0,x.A)({},e))})()})})]}):(0,f.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 ".concat(d),children:(0,f.jsx)("div",{className:"flex items-center justify-center h-64 text-gray-500 dark:text-gray-400",children:(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)(i.A,{className:"h-12 w-12 mx-auto mb-4"}),(0,f.jsx)("p",{children:"No data available for the selected timeframe"})]})})})};var v=a(4858),N=a(4228),w=a(2903),_=a(4538);const C=e=>{let{budgetInfo:t,onUpdateBudget:a,className:l=""}=e;const[i,n]=(0,s.useState)(!1),[m,g]=(0,s.useState)(!1),{control:h,handleSubmit:u,formState:{errors:y,isDirty:p},reset:b,watch:j}=(0,v.mN)({defaultValues:{monthlyLimit:t.monthly_limit,dailyLimit:t.monthly_limit/30,alertThreshold:80,enableAlerts:!0,enableHardStop:!1,emergencyContact:""}}),k=j();return(0,f.jsxs)("div",{className:"space-y-6 ".concat(l),children:[(0,f.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Budget Overview"}),(0,f.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Current month spending and limits"})]}),!i&&(0,f.jsxs)("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-3 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,f.jsx)(N.A,{className:"h-4 w-4"}),"Edit Budget"]})]}),(0,f.jsxs)("div",{className:"space-y-4",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Monthly Budget Progress"}),(0,f.jsxs)("span",{className:"text-sm font-semibold ".concat(t.budget_utilization_percentage>=90?"text-red-600 dark:text-red-400":t.budget_utilization_percentage>=75?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-green-400"),children:["$",t.current_month_spend.toFixed(2)," / $",t.monthly_limit.toFixed(2)]})]}),(0,f.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:(0,f.jsx)("div",{className:"h-3 rounded-full transition-all duration-500 ".concat(t.budget_utilization_percentage>=90?"bg-red-500":t.budget_utilization_percentage>=75?"bg-yellow-500":"bg-green-500"),style:{width:"".concat(Math.min(t.budget_utilization_percentage,100),"%")}})}),(0,f.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400",children:[(0,f.jsx)("span",{children:"0%"}),(0,f.jsxs)("span",{children:[t.budget_utilization_percentage.toFixed(1),"% used"]}),(0,f.jsx)("span",{children:"100%"})]})]}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsxs)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",t.remaining_budget.toFixed(2)]}),(0,f.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Remaining"})]}),(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsxs)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",t.projected_month_end_spend.toFixed(2)]}),(0,f.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Projected Total"})]}),(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsxs)("p",{className:"text-2xl font-bold ".concat(t.projected_month_end_spend>t.monthly_limit?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"),children:[t.projected_month_end_spend>t.monthly_limit?"+":"","$",(t.projected_month_end_spend-t.monthly_limit).toFixed(2)]}),(0,f.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.projected_month_end_spend>t.monthly_limit?"Over":"Under"," Budget"]})]})]}),(t.alerts.approaching_limit||t.alerts.over_budget||t.alerts.high_daily_spend)&&(0,f.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,f.jsx)(c.A,{className:"h-5 w-5 text-yellow-500"}),(0,f.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:"Active Alerts"})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[t.alerts.approaching_limit&&(0,f.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[(0,f.jsx)(w.A,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"}),(0,f.jsxs)("span",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:["Approaching monthly budget limit (",t.budget_utilization_percentage.toFixed(1),"% used)"]})]}),t.alerts.over_budget&&(0,f.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[(0,f.jsx)(c.A,{className:"h-4 w-4 text-red-600 dark:text-red-400"}),(0,f.jsx)("span",{className:"text-sm text-red-700 dark:text-red-300",children:"Monthly budget exceeded"})]}),t.alerts.high_daily_spend&&(0,f.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:[(0,f.jsx)(w.A,{className:"h-4 w-4 text-orange-600 dark:text-orange-400"}),(0,f.jsx)("span",{className:"text-sm text-orange-700 dark:text-orange-300",children:"Daily spending above average"})]})]})]})]}),i&&(0,f.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,f.jsx)(o.A,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"}),(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Budget Configuration"})]}),(0,f.jsxs)("form",{onSubmit:u(async e=>{g(!0);try{await a(e),n(!1),b(e)}catch(t){console.error("Failed to update budget:",t)}finally{g(!1)}}),className:"space-y-6",children:[(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Monthly Budget Limit"}),(0,f.jsx)(v.xI,{name:"monthlyLimit",control:h,rules:{required:"Monthly limit is required",min:{value:1,message:"Must be at least $1"},max:{value:1e4,message:"Must be less than $10,000"}},render:e=>{let{field:t}=e;return(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)(d.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,f.jsx)("input",(0,x.A)((0,x.A)({},t),{},{type:"number",step:"0.01",min:"1",max:"10000",className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"100.00"}))]})}}),y.monthlyLimit&&(0,f.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:y.monthlyLimit.message})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Daily Budget Limit (Optional)"}),(0,f.jsx)(v.xI,{name:"dailyLimit",control:h,rules:{min:{value:.01,message:"Must be at least $0.01"},validate:e=>{if(e&&30*e>k.monthlyLimit)return"Daily limit would exceed monthly limit"}},render:e=>{let{field:t}=e;return(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)(d.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,f.jsx)("input",(0,x.A)((0,x.A)({},t),{},{type:"number",step:"0.01",min:"0.01",className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"10.00"}))]})}}),y.dailyLimit&&(0,f.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:y.dailyLimit.message})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Alert Threshold (%)"}),(0,f.jsx)(v.xI,{name:"alertThreshold",control:h,rules:{required:"Alert threshold is required",min:{value:50,message:"Must be at least 50%"},max:{value:95,message:"Must be less than 95%"}},render:e=>{let{field:t}=e;return(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)("input",(0,x.A)((0,x.A)({},t),{},{type:"number",min:"50",max:"95",className:"w-full pr-8 pl-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"80"})),(0,f.jsx)("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:"%"})]})}}),y.alertThreshold&&(0,f.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:y.alertThreshold.message}),(0,f.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["Get notified when ",k.alertThreshold,"% of budget is used"]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Emergency Contact (Optional)"}),(0,f.jsx)(v.xI,{name:"emergencyContact",control:h,rules:{pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}},render:e=>{let{field:t}=e;return(0,f.jsx)("input",(0,x.A)((0,x.A)({},t),{},{type:"email",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"admin@company.com"}))}}),y.emergencyContact&&(0,f.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:y.emergencyContact.message})]})]}),(0,f.jsxs)("div",{className:"space-y-4",children:[(0,f.jsx)(v.xI,{name:"enableAlerts",control:h,render:e=>{let{field:{value:t,onChange:a}}=e;return(0,f.jsxs)("label",{className:"flex items-center",children:[(0,f.jsx)("input",{type:"checkbox",checked:t,onChange:a,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"}),(0,f.jsx)("span",{className:"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Enable budget alerts"})]})}}),(0,f.jsx)(v.xI,{name:"enableHardStop",control:h,render:e=>{let{field:{value:t,onChange:a}}=e;return(0,f.jsxs)("label",{className:"flex items-center",children:[(0,f.jsx)("input",{type:"checkbox",checked:t,onChange:a,className:"h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 dark:border-gray-600 rounded"}),(0,f.jsx)("span",{className:"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Enable hard stop (block requests when budget exceeded)"})]})}}),k.enableHardStop&&(0,f.jsx)("div",{className:"ml-7 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)(c.A,{className:"h-4 w-4 text-red-600 dark:text-red-400"}),(0,f.jsx)("span",{className:"text-sm text-red-700 dark:text-red-300 font-medium",children:"Warning: Hard stop will completely block AI requests when budget is exceeded"})]})})]}),(0,f.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,f.jsx)("button",{type:"button",onClick:()=>{b(),n(!1)},className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),(0,f.jsxs)("button",{type:"submit",disabled:!p||m,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[m?(0,f.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):(0,f.jsx)(_.A,{className:"h-4 w-4"}),m?"Saving...":"Save Budget Settings"]})]})]})]}),(0,f.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Recent Alerts"}),(0,f.jsx)("button",{className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300",children:"View All"})]}),(0,f.jsx)("div",{className:"space-y-3",children:[{id:"1",type:"warning",message:"Daily spend exceeded average by 25%",actionRequired:!1,timestamp:"2025-01-12T10:30:00Z"},{id:"2",type:"info",message:"Monthly budget tracking on schedule",actionRequired:!1,timestamp:"2025-01-12T09:15:00Z"}].map(e=>(0,f.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-lg ".concat("warning"===e.type?"bg-yellow-50 dark:bg-yellow-900/20":"danger"===e.type?"bg-red-50 dark:bg-red-900/20":"bg-blue-50 dark:bg-blue-900/20"),children:["warning"===e.type?(0,f.jsx)(c.A,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}):"danger"===e.type?(0,f.jsx)(c.A,{className:"h-5 w-5 text-red-600 dark:text-red-400 mt-0.5"}):(0,f.jsx)(_.A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5"}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsx)("p",{className:"text-sm font-medium ".concat("warning"===e.type?"text-yellow-700 dark:text-yellow-300":"danger"===e.type?"text-red-700 dark:text-red-300":"text-blue-700 dark:text-blue-300"),children:e.message}),(0,f.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:new Date(e.timestamp).toLocaleString()})]}),e.actionRequired&&(0,f.jsx)("button",{className:"text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 px-2 py-1 rounded",children:"Action Required"})]},e.id))})]})]})};var A=a(2275),P=a(7426),M=a(6036);m.t1.register(m.PP,m.kc,m.FN,m.No,m.hE,m.m_,m.s$,m.dN);const S=e=>{let{historicalData:t,monthlyBudget:a,className:o=""}=e;const[m,u]=(0,s.useState)("all"),[y,p]=(0,s.useState)("month"),k=[{name:"conservative",label:"Conservative",color:"rgb(34, 197, 94)",multiplier:1.1,description:"Assumes minimal growth in usage"},{name:"realistic",label:"Realistic",color:"rgb(59, 130, 246)",multiplier:1.25,description:"Based on current trends"},{name:"optimistic",label:"Optimistic",color:"rgb(239, 68, 68)",multiplier:1.4,description:"Assumes increased usage patterns"}],v=(0,s.useMemo)(()=>{if(!t||0===t.length)return[];const e=new Date,a=((0,A.w)(e),(0,P.p)(e),t.slice(-7)),s=a.reduce((e,t)=>e+t.cost,0)/a.length,r=t.slice(0,Math.floor(t.length/2)),l=t.slice(Math.floor(t.length/2)),i=r.reduce((e,t)=>e+t.cost,0)/r.length,d=l.reduce((e,t)=>e+t.cost,0)/l.length,n=(d>0?(d-i)/i:0)/l.length,o="month"===y?30:"quarter"===y?90:365,c=[];for(let t=0;t<=o;t++){const a=(0,h.GP)((0,M.f)(e,t),"yyyy-MM-dd");k.forEach(e=>{const r=s*(1+n*t)*e.multiplier,l=.1*Math.random()-.05,i=Math.max(0,r*(1+l));let d;d=t<=7?"high":t<=30?"medium":"low",c.push({date:a,projectedCost:i,confidence:d,scenario:e.name})})}return c},[t,y]),N=(0,s.useMemo)(()=>{const e=v.filter((e,t)=>t<90);return k.map(t=>{const s=e.filter(e=>e.scenario===t.name),r=s.reduce((e,t)=>e+t.projectedCost,0),l=r/(s.length||1);return(0,x.A)((0,x.A)({},t),{},{totalCost:r,avgDailyCost:l,budgetUtilization:r/a*100,overBudget:r>a})})},[v,a,k]),w=(0,s.useMemo)(()=>{const e="all"===m?v:v.filter(e=>e.scenario===m);return{datasets:k.filter(e=>"all"===m||e.name===m).map(t=>{const a=e.filter(e=>e.scenario===t.name).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime());return{label:t.label,data:a.map(e=>({x:e.date,y:e.projectedCost})),borderColor:t.color,backgroundColor:t.color.replace("rgb","rgba").replace(")",", 0.1)"),tension:.4,fill:!1,pointRadius:0,pointHoverRadius:5,pointHoverBackgroundColor:t.color,pointHoverBorderColor:"white",pointHoverBorderWidth:2}})}},[v,k,m]),_={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top",labels:{color:"rgb(107, 114, 128)",usePointStyle:!0,pointStyle:"circle"}},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(17, 24, 39, 0.95)",titleColor:"rgb(243, 244, 246)",bodyColor:"rgb(209, 213, 219)",borderColor:"rgb(75, 85, 99)",borderWidth:1,cornerRadius:8,callbacks:{title:e=>(0,h.GP)(new Date(e[0].parsed.x),"MMM dd, yyyy"),label:e=>"".concat(e.dataset.label,": $").concat(e.parsed.y.toFixed(2))}}},scales:{x:{type:"time",time:{unit:"day",displayFormats:{day:"MMM dd"}},grid:{color:"rgba(107, 114, 128, 0.1)",drawBorder:!1},ticks:{color:"rgb(107, 114, 128)",maxTicksLimit:8}},y:{beginAtZero:!0,grid:{color:"rgba(107, 114, 128, 0.1)",drawBorder:!1},ticks:{color:"rgb(107, 114, 128)",callback:function(e){return"$".concat(e.toFixed(2))}}}},interaction:{mode:"nearest",axis:"x",intersect:!1},animation:{duration:1e3,easing:"easeInOutQuart"}};return(0,f.jsxs)("div",{className:"space-y-6 ".concat(o),children:[(0,f.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Cost Projections & Trends"}),(0,f.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Predictive analysis based on historical usage patterns"})]}),(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[{value:"month",label:"30 Days"},{value:"quarter",label:"90 Days"},{value:"year",label:"1 Year"}].map(e=>(0,f.jsx)("button",{onClick:()=>p(e.value),className:"px-3 py-1 rounded-md text-sm font-medium transition-colors ".concat(y===e.value?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"),children:e.label},e.value))}),(0,f.jsxs)("select",{value:m,onChange:e=>u(e.target.value),className:"px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,f.jsx)("option",{value:"all",children:"All Scenarios"}),k.map(e=>(0,f.jsx)("option",{value:e.name,children:e.label},e.name))]})]})]}),(0,f.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:N.map(e=>(0,f.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,f.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white",children:e.label})]}),e.overBudget&&(0,f.jsx)(c.A,{className:"h-5 w-5 text-red-500"})]}),(0,f.jsxs)("div",{className:"space-y-3",children:[(0,f.jsxs)("div",{children:[(0,f.jsxs)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",e.totalCost.toFixed(2)]}),(0,f.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Projected monthly cost"})]}),(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Daily average"}),(0,f.jsxs)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["$",e.avgDailyCost.toFixed(2)]})]}),(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Budget usage"}),(0,f.jsxs)("span",{className:"text-sm font-medium ".concat(e.overBudget?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"),children:[e.budgetUtilization.toFixed(1),"%"]})]}),(0,f.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:(0,f.jsx)("div",{className:"h-2 rounded-full transition-all duration-500 ".concat(e.overBudget?"bg-red-500":"bg-green-500"),style:{width:"".concat(Math.min(e.budgetUtilization,100),"%")}})}),(0,f.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.description})]})]},e.name))}),(0,f.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,f.jsx)(i.A,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"}),(0,f.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Cost Projection Trends"})]}),(0,f.jsx)("div",{className:"h-[400px]",children:v.length>0?(0,f.jsx)(g.N1,{data:w,options:_}):(0,f.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)(i.A,{className:"h-12 w-12 mx-auto mb-4"}),(0,f.jsx)("p",{children:"Insufficient data for projections"}),(0,f.jsx)("p",{className:"text-sm mt-2",children:"Need at least 7 days of historical data"})]})})})]}),(0,f.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,f.jsx)(l.A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),(0,f.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Key Insights"})]}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("h5",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Trend Analysis"}),(0,f.jsx)("div",{className:"space-y-2",children:N.map(e=>(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),(0,f.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.label})]}),(0,f.jsxs)("div",{className:"flex items-center gap-1",children:[e.budgetUtilization>100?(0,f.jsx)(b.A,{className:"h-4 w-4 text-red-500"}):(0,f.jsx)(j.A,{className:"h-4 w-4 text-green-500"}),(0,f.jsxs)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[e.budgetUtilization.toFixed(0),"%"]})]})]},e.name))})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h5",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Recommendations"}),(0,f.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[N.some(e=>e.overBudget)&&(0,f.jsxs)("div",{className:"flex items-start gap-2",children:[(0,f.jsx)(c.A,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),(0,f.jsx)("span",{children:"Consider budget increase or usage optimization"})]}),(0,f.jsxs)("div",{className:"flex items-start gap-2",children:[(0,f.jsx)(n.A,{className:"h-4 w-4 text-blue-500 mt-0.5 flex-shrink-0"}),(0,f.jsx)("span",{children:"Monitor daily usage patterns for early detection"})]}),(0,f.jsxs)("div",{className:"flex items-start gap-2",children:[(0,f.jsx)(d.A,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),(0,f.jsx)("span",{children:"Review cost optimization opportunities weekly"})]})]})]})]})]})]})};var D=a(7985),F=a(5041),I=a(2153),T=a(3058),R=a(6287);const q=e=>{let{costData:t,historicalData:a,onImplementRecommendation:l,className:c=""}=e;const[x,m]=(0,s.useState)("all"),[g,h]=(0,s.useState)("all"),[u,y]=(0,s.useState)(new Set),p=(0,s.useMemo)(()=>{const e=[];t.cost_by_model["gpt-4"]&&t.cost_by_model["gpt-4"]>.6*t.total_cost&&e.push({id:"model-optimization-1",title:"Switch to GPT-3.5-turbo for Simple Tasks",description:"GPT-4 is being used for 60%+ of requests. Consider using GPT-3.5-turbo for simpler tasks like data extraction and basic analysis.",category:"model",priority:"high",potentialSavings:.3*t.cost_by_model["gpt-4"],savingsPercentage:30,complexity:"easy",timeToImplement:"1-2 hours",impact:"immediate",actionItems:["Audit current GPT-4 usage patterns","Identify tasks suitable for GPT-3.5-turbo","Implement model selection logic","Monitor quality metrics after switch"],metrics:{currentCost:t.cost_by_model["gpt-4"],projectedCost:.7*t.cost_by_model["gpt-4"],affectedRequests:Math.floor(.3*t.token_usage.total_tokens/1e3)}}),t.token_usage.output_tokens>.8*t.token_usage.input_tokens&&e.push({id:"token-optimization-1",title:"Optimize Prompt Length and Output",description:"Output tokens are consuming significant costs. Optimize prompts to be more concise and limit response length.",category:"usage",priority:"medium",potentialSavings:.15*t.total_cost,savingsPercentage:15,complexity:"moderate",timeToImplement:"3-5 hours",impact:"short-term",actionItems:["Analyze prompt patterns for redundancy","Implement response length limits","Add prompt optimization guidelines","A/B test shorter prompts"],metrics:{currentCost:t.total_cost,projectedCost:.85*t.total_cost,affectedRequests:Math.floor(t.token_usage.total_tokens/1e3)}});e.push({id:"caching-1",title:"Implement Response Caching",description:"High repeat request rate detected. Implement caching for frequently requested analyses.",category:"caching",priority:"high",potentialSavings:.25*t.total_cost,savingsPercentage:25,complexity:"moderate",timeToImplement:"1-2 days",impact:"immediate",actionItems:["Set up Redis caching layer","Identify cacheable request patterns","Implement cache invalidation strategy","Monitor cache hit rates"],metrics:{currentCost:t.total_cost,projectedCost:.75*t.total_cost,affectedRequests:Math.floor(.25*t.token_usage.total_tokens/1e3)}});return(a.length>1?Math.max(...a.map(e=>e.cost))/Math.min(...a.map(e=>e.cost)):1)>2&&e.push({id:"scheduling-1",title:"Implement Off-Peak Processing",description:"High cost variance detected. Schedule batch processing during off-peak hours for cost savings.",category:"scheduling",priority:"medium",potentialSavings:.12*t.total_cost,savingsPercentage:12,complexity:"complex",timeToImplement:"2-3 days",impact:"long-term",actionItems:["Analyze usage patterns by time of day","Implement job queue system","Set up scheduled batch processing","Monitor cost patterns after implementation"],metrics:{currentCost:t.total_cost,projectedCost:.88*t.total_cost,affectedRequests:Math.floor(.3*t.token_usage.total_tokens/1e3)}}),e.push({id:"architecture-1",title:"Implement Request Batching",description:"Process multiple similar requests in batches to reduce per-request overhead and improve efficiency.",category:"architecture",priority:"low",potentialSavings:.08*t.total_cost,savingsPercentage:8,complexity:"complex",timeToImplement:"1 week",impact:"long-term",actionItems:["Design batch processing architecture","Implement request queuing system","Add batch size optimization logic","Test and validate batch processing"],metrics:{currentCost:t.total_cost,projectedCost:.92*t.total_cost,affectedRequests:Math.floor(t.token_usage.total_tokens/1e3)}}),e.sort((e,t)=>{const a={high:3,medium:2,low:1};return a[t.priority]-a[e.priority]||t.potentialSavings-e.potentialSavings})},[t,a]),b=(0,s.useMemo)(()=>p.filter(e=>{const t="all"===x||e.priority===x,a="all"===g||e.category===g;return t&&a}),[p,x,g]),j=(0,s.useMemo)(()=>b.reduce((e,t)=>e+t.potentialSavings,0),[b]),k=e=>{switch(e){case"high":return"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300";case"medium":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-300";case"low":return"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300"}},v=e=>{switch(e){case"easy":return"text-green-600 dark:text-green-400";case"moderate":return"text-yellow-600 dark:text-yellow-400";case"complex":return"text-red-600 dark:text-red-400"}};return(0,f.jsxs)("div",{className:"space-y-6 ".concat(c),children:[(0,f.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Cost Optimization Recommendations"}),(0,f.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Potential savings: ",(0,f.jsxs)("span",{className:"font-medium text-green-600 dark:text-green-400",children:["$",j.toFixed(2)]})," (",b.length," recommendations)"]})]}),(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsxs)("select",{value:x,onChange:e=>m(e.target.value),className:"px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,f.jsx)("option",{value:"all",children:"All Priorities"}),(0,f.jsx)("option",{value:"high",children:"High Priority"}),(0,f.jsx)("option",{value:"medium",children:"Medium Priority"}),(0,f.jsx)("option",{value:"low",children:"Low Priority"})]}),(0,f.jsxs)("select",{value:g,onChange:e=>h(e.target.value),className:"px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,f.jsx)("option",{value:"all",children:"All Categories"}),(0,f.jsx)("option",{value:"model",children:"Model Optimization"}),(0,f.jsx)("option",{value:"usage",children:"Usage Optimization"}),(0,f.jsx)("option",{value:"scheduling",children:"Scheduling"}),(0,f.jsx)("option",{value:"caching",children:"Caching"}),(0,f.jsx)("option",{value:"architecture",children:"Architecture"})]})]})]}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,f.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)(d.A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),(0,f.jsx)("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Total Savings"})]}),(0,f.jsxs)("p",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100 mt-1",children:["$",j.toFixed(2)]})]}),(0,f.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)(T.A,{className:"h-5 w-5 text-red-600 dark:text-red-400"}),(0,f.jsx)("span",{className:"text-sm font-medium text-red-700 dark:text-red-300",children:"High Priority"})]}),(0,f.jsx)("p",{className:"text-2xl font-bold text-red-900 dark:text-red-100 mt-1",children:p.filter(e=>"high"===e.priority).length})]}),(0,f.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)(_.A,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),(0,f.jsx)("span",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Quick Wins"})]}),(0,f.jsx)("p",{className:"text-2xl font-bold text-green-900 dark:text-green-100 mt-1",children:p.filter(e=>"easy"===e.complexity).length})]}),(0,f.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)(F.A,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"}),(0,f.jsx)("span",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Immediate Impact"})]}),(0,f.jsx)("p",{className:"text-2xl font-bold text-purple-900 dark:text-purple-100 mt-1",children:p.filter(e=>"immediate"===e.impact).length})]})]}),(0,f.jsx)("div",{className:"grid grid-cols-1 gap-6",children:b.map((e,t)=>{const a=(e=>{switch(e){case"model":return D.A;case"usage":return i.A;case"scheduling":return n.A;case"caching":return F.A;case"architecture":return o.A;default:return I.A}})(e.category),s=u.has(e.id);return(0,f.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,f.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,f.jsxs)("div",{className:"flex items-start gap-4",children:[(0,f.jsx)("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:(0,f.jsx)(a,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,f.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e.title}),(0,f.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(k(e.priority)),children:e.priority})]}),(0,f.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:e.description}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Potential Savings"}),(0,f.jsxs)("p",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:["$",e.potentialSavings.toFixed(2)]}),(0,f.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.savingsPercentage,"% reduction"]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Complexity"}),(0,f.jsx)("p",{className:"text-sm font-medium ".concat(v(e.complexity)),children:e.complexity}),(0,f.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.timeToImplement})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Impact"}),(0,f.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 capitalize",children:e.impact}),(0,f.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.metrics.affectedRequests.toLocaleString()," requests"]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Cost Projection"}),(0,f.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["$",e.metrics.currentCost.toFixed(2)," \u2192 $",e.metrics.projectedCost.toFixed(2)]}),(0,f.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1 mt-1",children:(0,f.jsx)("div",{className:"bg-green-500 h-1 rounded-full",style:{width:"".concat(100*(1-e.metrics.projectedCost/e.metrics.currentCost),"%")}})})]})]})]})]}),(0,f.jsxs)("button",{onClick:()=>(async e=>{y(t=>new Set(Array.from(t).concat(e)));try{await l(e)}catch(t){console.error("Failed to implement recommendation:",t)}finally{y(t=>{const a=new Set(t);return a.delete(e),a})}})(e.id),disabled:s||e.implemented,className:"flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ".concat(e.implemented?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300":"bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50"),children:[s?(0,f.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):e.implemented?(0,f.jsx)(_.A,{className:"h-4 w-4"}):(0,f.jsx)(R.A,{className:"h-4 w-4"}),s?"Implementing...":e.implemented?"Implemented":"Implement"]})]}),(0,f.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[(0,f.jsx)("h5",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Implementation Steps:"}),(0,f.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:e.actionItems.map((e,t)=>(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-600 dark:bg-blue-400 flex-shrink-0 mt-2"}),(0,f.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:e})]},t))})]})]},e.id)})}),0===b.length&&(0,f.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-12 text-center",children:[(0,f.jsx)(I.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,f.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No recommendations match your filters"}),(0,f.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Try adjusting your priority or category filters to see more recommendations."})]})]})};var B=a(2704),z=a(1663),L=a(8416);const E=e=>{let{costData:t,historicalData:a,onExport:l,className:i=""}=e;const[d,n]=(0,s.useState)(!1),[m,g]=(0,s.useState)(null),[h,u]=(0,s.useState)({format:"pdf",timeRange:"last30days",includeCharts:!0,includeProjections:!1,includeRecommendations:!1}),y=[{id:"pdf",name:"PDF Report",extension:"pdf",icon:B.A,description:"Comprehensive report with charts and analysis",size:"~2-5 MB"},{id:"csv",name:"CSV Data",extension:"csv",icon:z.A,description:"Raw data for further analysis",size:"~50-200 KB"},{id:"excel",name:"Excel Workbook",extension:"xlsx",icon:z.A,description:"Multi-sheet workbook with formulas",size:"~100-500 KB"},{id:"json",name:"JSON Data",extension:"json",icon:o.A,description:"Structured data for API integration",size:"~10-100 KB"}],p=[{value:"last7days",label:"Last 7 days"},{value:"last30days",label:"Last 30 days"},{value:"last90days",label:"Last 90 days"},{value:"custom",label:"Custom range"}],b=()=>{const e=.1*a.length;let t=1;switch(h.includeCharts&&(t+=.5),h.includeProjections&&(t+=.3),h.includeRecommendations&&(t+=.2),h.format){case"pdf":return"~".concat(Math.round(e*t*10),"KB - ").concat(Math.round(e*t*20),"KB");case"csv":return"~".concat(Math.round(e*t*2),"KB");case"excel":return"~".concat(Math.round(e*t*5),"KB");case"json":return"~".concat(Math.round(e*t),"KB");default:return"Unknown"}},j=()=>{var e;const t=y.find(e=>e.id===h.format),a=(null===(e=p.find(e=>e.value===h.timeRange))||void 0===e?void 0:e.label)||"Custom",s=[];return h.includeCharts&&s.push("Charts"),h.includeProjections&&s.push("Projections"),h.includeRecommendations&&s.push("Recommendations"),{format:(null===t||void 0===t?void 0:t.name)||"Unknown",timeRange:a,sections:s.length>0?s:["Basic data only"],estimatedSize:b()}};return d?(0,f.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,f.jsxs)(r.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)(L.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Export Cost Analytics"}),(0,f.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Generate reports and download data in various formats"})]})]}),(0,f.jsx)("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:(0,f.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,f.jsxs)("div",{className:"flex max-h-[calc(90vh-120px)]",children:[(0,f.jsxs)("div",{className:"flex-1 p-6 overflow-y-auto border-r border-gray-200 dark:border-gray-700",children:[(0,f.jsxs)("div",{className:"mb-6",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Export Format"}),(0,f.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:y.map(e=>{const t=e.icon;return(0,f.jsxs)("label",{className:"flex items-start gap-3 p-4 border rounded-lg cursor-pointer transition-colors ".concat(h.format===e.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"),children:[(0,f.jsx)("input",{type:"radio",name:"format",value:e.id,checked:h.format===e.id,onChange:e=>u(t=>(0,x.A)((0,x.A)({},t),{},{format:e.target.value})),className:"mt-1"}),(0,f.jsx)(t,{className:"h-5 w-5 text-gray-600 dark:text-gray-400 mt-0.5"}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),(0,f.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description}),e.size&&(0,f.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:e.size})]})]},e.id)})})]}),(0,f.jsxs)("div",{className:"mb-6",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Time Range"}),(0,f.jsx)("div",{className:"space-y-3",children:p.map(e=>(0,f.jsxs)("label",{className:"flex items-center",children:[(0,f.jsx)("input",{type:"radio",name:"timeRange",value:e.value,checked:h.timeRange===e.value,onChange:e=>u(t=>(0,x.A)((0,x.A)({},t),{},{timeRange:e.target.value})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500"}),(0,f.jsx)("span",{className:"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300",children:e.label})]},e.value))}),"custom"===h.timeRange&&(0,f.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Start Date"}),(0,f.jsx)("input",{type:"date",value:h.customStartDate||"",onChange:e=>u(t=>(0,x.A)((0,x.A)({},t),{},{customStartDate:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"End Date"}),(0,f.jsx)("input",{type:"date",value:h.customEndDate||"",onChange:e=>u(t=>(0,x.A)((0,x.A)({},t),{},{customEndDate:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]})]})]}),("pdf"===h.format||"excel"===h.format)&&(0,f.jsxs)("div",{className:"mb-6",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Include in Export"}),(0,f.jsxs)("div",{className:"space-y-3",children:[(0,f.jsxs)("label",{className:"flex items-center",children:[(0,f.jsx)("input",{type:"checkbox",checked:h.includeCharts,onChange:e=>u(t=>(0,x.A)((0,x.A)({},t),{},{includeCharts:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 rounded"}),(0,f.jsx)("span",{className:"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Charts and Visualizations"})]}),(0,f.jsxs)("label",{className:"flex items-center",children:[(0,f.jsx)("input",{type:"checkbox",checked:h.includeProjections,onChange:e=>u(t=>(0,x.A)((0,x.A)({},t),{},{includeProjections:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 rounded"}),(0,f.jsx)("span",{className:"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Cost Projections"})]}),(0,f.jsxs)("label",{className:"flex items-center",children:[(0,f.jsx)("input",{type:"checkbox",checked:h.includeRecommendations,onChange:e=>u(t=>(0,x.A)((0,x.A)({},t),{},{includeRecommendations:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 rounded"}),(0,f.jsx)("span",{className:"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Optimization Recommendations"})]})]})]})]}),(0,f.jsxs)("div",{className:"w-80 p-6 bg-gray-50 dark:bg-gray-900",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Export Preview"}),(0,f.jsxs)("div",{className:"space-y-4",children:[(0,f.jsxs)("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,f.jsx)(B.A,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),(0,f.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:j().format})]}),(0,f.jsxs)("div",{className:"text-xs space-y-1",children:[(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Time Range:"}),(0,f.jsx)("span",{className:"text-gray-900 dark:text-white",children:j().timeRange})]}),(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Est. Size:"}),(0,f.jsx)("span",{className:"text-gray-900 dark:text-white",children:j().estimatedSize})]})]})]}),(0,f.jsxs)("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,f.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Content Sections"}),(0,f.jsx)("div",{className:"space-y-1",children:j().sections.map((e,t)=>(0,f.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,f.jsx)(_.A,{className:"h-3 w-3 text-green-600 dark:text-green-400"}),(0,f.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:e})]},t))})]}),(0,f.jsxs)("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,f.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Data Summary"}),(0,f.jsxs)("div",{className:"text-xs space-y-1",children:[(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Cost:"}),(0,f.jsxs)("span",{className:"text-gray-900 dark:text-white",children:["$",t.total_cost.toFixed(2)]})]}),(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Days:"}),(0,f.jsx)("span",{className:"text-gray-900 dark:text-white",children:a.length})]}),(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Models:"}),(0,f.jsx)("span",{className:"text-gray-900 dark:text-white",children:Object.keys(t.cost_by_model).length})]})]})]}),(h.includeCharts||"last90days"===h.timeRange)&&(0,f.jsx)("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:(0,f.jsxs)("div",{className:"flex items-start gap-2",children:[(0,f.jsx)(c.A,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-xs font-medium text-yellow-700 dark:text-yellow-300",children:"Large Export"}),(0,f.jsx)("p",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:"This export may take longer to generate due to the amount of data or included charts."})]})]})})]})]})]}),(0,f.jsxs)("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 dark:border-gray-700",children:[(0,f.jsx)("button",{onClick:()=>n(!1),className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),(0,f.jsxs)("button",{onClick:()=>(async e=>{g(e);try{const t=(0,x.A)((0,x.A)({},h),{},{format:e}),a=await l(t),s=document.createElement("a");s.href=a.url,s.download=a.filename,document.body.appendChild(s),s.click(),document.body.removeChild(s),n(!1)}catch(t){console.error("Export failed:",t)}finally{g(null)}})(h.format),disabled:m===h.format,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[m===h.format?(0,f.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):(0,f.jsx)(L.A,{className:"h-4 w-4"}),m===h.format?"Generating...":"Export ".concat(j().format)]})]})]})}):(0,f.jsxs)("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors ".concat(i),children:[(0,f.jsx)(L.A,{className:"h-4 w-4"}),"Export"]})};var $=a(3248),O=a(8991),H=a(2149),G=a(6859),K=a(8007);const U="/api",W=async()=>{const e=await fetch("".concat(U,"/budget/info"));if(!e.ok)throw new Error("Failed to fetch budget info: ".concat(e.statusText));const t=await e.json();var a;if(!t.success)throw new Error((null===(a=t.error)||void 0===a?void 0:a.message)||"Failed to fetch budget info");return t.data},Q=async e=>{const t=await fetch("".concat(U,"/budget/update"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to update budget: ".concat(t.statusText));const a=await t.json();var s;if(!a.success)throw new Error((null===(s=a.error)||void 0===s?void 0:s.message)||"Failed to update budget");return a.data},V={all:["cost"],analytics:e=>[...V.all,"analytics",e],historical:e=>[...V.all,"historical",e],budget:()=>[...V.all,"budget"]},Z={timeframe:"30d",models:void 0,operations:void 0},J=function(){var e,t,a,r;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{autoRefresh:i=!0,refreshInterval:d=3e4,filters:n=Z}=l,o=(0,$.jE)(),[c,m]=(0,s.useState)(n),[g,u]=(0,s.useState)(null),y=(0,s.useMemo)(()=>{const e=new Date;let t,a;if(c.startDate&&c.endDate)t=(0,G.o)(c.startDate),a=(0,G.o)(c.endDate);else switch(a=(0,G.o)(e),c.timeframe){case"7d":t=(0,G.o)((0,K.e)(e,7));break;case"90d":t=(0,G.o)((0,K.e)(e,90));break;default:t=(0,G.o)((0,K.e)(e,30))}return{start:t,end:a}},[c]),p=(0,s.useMemo)(()=>(0,x.A)((0,x.A)({},c),{},{startDate:y.start,endDate:y.end}),[c,y]),b=(0,O.I)({queryKey:V.analytics(p),queryFn:()=>(async e=>{var t,a;const s=new URLSearchParams;e.timeframe&&s.append("timeframe",e.timeframe),e.startDate&&s.append("start_date",(0,h.GP)(e.startDate,"yyyy-MM-dd")),e.endDate&&s.append("end_date",(0,h.GP)(e.endDate,"yyyy-MM-dd")),null!==(t=e.models)&&void 0!==t&&t.length&&s.append("models",e.models.join(",")),null!==(a=e.operations)&&void 0!==a&&a.length&&s.append("operations",e.operations.join(","));const r=await fetch("".concat(U,"/analytics/costs?").concat(s));if(!r.ok)throw new Error("Failed to fetch cost analytics: ".concat(r.statusText));const l=await r.json();var i;if(!l.success)throw new Error((null===(i=l.error)||void 0===i?void 0:i.message)||"Failed to fetch cost analytics");return l.data})(p),staleTime:i?d:1/0,refetchInterval:!!i&&d,retry:(e,t)=>!(t instanceof Error&&t.message.includes("4"))&&e<3}),j=(0,O.I)({queryKey:V.historical(p),queryFn:()=>(async e=>{const t=new URLSearchParams;e.timeframe&&t.append("timeframe",e.timeframe),e.startDate&&t.append("start_date",(0,h.GP)(e.startDate,"yyyy-MM-dd")),e.endDate&&t.append("end_date",(0,h.GP)(e.endDate,"yyyy-MM-dd"));const a=await fetch("".concat(U,"/analytics/historical?").concat(t));if(!a.ok)throw new Error("Failed to fetch historical data: ".concat(a.statusText));const s=await a.json();var r;if(!s.success)throw new Error((null===(r=s.error)||void 0===r?void 0:r.message)||"Failed to fetch historical data");return s.data})(p),staleTime:i?d:1/0,refetchInterval:!!i&&d,retry:(e,t)=>!(t instanceof Error&&t.message.includes("4"))&&e<3}),f=(0,O.I)({queryKey:V.budget(),queryFn:W,staleTime:i?2*d:1/0,refetchInterval:!!i&&2*d,retry:(e,t)=>!(t instanceof Error&&t.message.includes("4"))&&e<3}),k=(0,H.n)({mutationFn:Q,onSuccess:e=>{o.setQueryData(V.budget(),e),u(null)}});(0,s.useEffect)(()=>{(b.data||j.data||f.data)&&u(null)},[b.data,j.data,f.data]);const v=(0,s.useCallback)(e=>{m(t=>(0,x.A)((0,x.A)({},t),e))},[]),N=(0,s.useCallback)(async()=>{u(null),await Promise.all([b.refetch(),j.refetch(),f.refetch()])},[b,j,f]),w=(0,s.useCallback)(async e=>{await k.mutateAsync(e)},[k]),_=(0,s.useCallback)(()=>{o.removeQueries({queryKey:V.all}),u(null)},[o]),C=b.isLoading||j.isLoading||f.isLoading,A=g||(null===(e=b.error)||void 0===e?void 0:e.message)||(null===(t=j.error)||void 0===t?void 0:t.message)||(null===(a=f.error)||void 0===a?void 0:a.message)||(null===(r=k.error)||void 0===r?void 0:r.message)||null;return{analytics:b.data||null,historicalData:j.data||[],budgetInfo:f.data||null,filters:p,isLoading:C,error:A,refetch:N,updateFilters:v,updateBudget:w,clearCache:_}},Y=e=>{let{className:t=""}=e;const[a,x]=(0,s.useState)("overview"),[m,g]=(0,s.useState)("30d"),{analytics:h,historicalData:u,budgetInfo:y,isLoading:p,error:b,updateFilters:j,updateBudget:v,refetch:N}=J({filters:{timeframe:m},autoRefresh:!0}),{insights:w}=(()=>{const{analytics:e,historicalData:t,isLoading:a,error:r}=J();return{insights:(0,s.useMemo)(()=>{if(!e||!t||0===t.length)return null;const a=t.slice(-7),s=t.slice(-14,-7),r=a.reduce((e,t)=>e+t.cost,0)/a.length,l=s.reduce((e,t)=>e+t.cost,0)/s.length||r;return{trend:r>l?"increasing":r<l?"decreasing":"stable",trendPercentage:l>0?Math.abs((r-l)/l*100):0,peakDay:t.reduce((e,t)=>t.cost>e.cost?t:e),avgCostPerToken:e.token_usage.total_tokens>0?e.total_cost/e.token_usage.total_tokens:0,dailyAverage:r,weeklyChange:r-l,mostExpensiveModel:Object.keys(e.cost_by_model).reduce((t,a)=>e.cost_by_model[t]>e.cost_by_model[a]?t:a)}},[e,t]),isLoading:a,error:r}})(),_=[{id:"overview",label:"Overview",icon:l.A},{id:"charts",label:"Charts",icon:i.A},{id:"budget",label:"Budget",icon:d.A},{id:"projections",label:"Projections",icon:n.A},{id:"recommendations",label:"Optimize",icon:o.A}];if(p)return(0,f.jsx)("div",{className:"max-w-7xl mx-auto p-6 space-y-6 ".concat(t),children:(0,f.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent mx-auto mb-4"}),(0,f.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading cost analytics..."})]})})});if(b&&!h&&!u.length)return(0,f.jsx)("div",{className:"max-w-7xl mx-auto p-6 space-y-6 ".concat(t),children:(0,f.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)(c.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,f.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Failed to load cost data"}),(0,f.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:b}),(0,f.jsx)("button",{onClick:()=>N(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"})]})})});const A=h||{total_cost:0,daily_costs:[],cost_by_model:{},cost_by_operation:{},token_usage:{total_tokens:0,input_tokens:0,output_tokens:0},projected_monthly_cost:0,timeframe:"7d"===m?"7 days":"90d"===m?"90 days":"30 days"},P=y||{monthly_limit:0,current_month_spend:0,remaining_budget:0,budget_utilization_percentage:0,projected_month_end_spend:0,alerts:{approaching_limit:!1,over_budget:!1,high_daily_spend:!1}};return(0,f.jsxs)("div",{className:"max-w-7xl mx-auto p-6 space-y-6 ".concat(t),children:[(0,f.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Cost Analytics Dashboard"}),(0,f.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Monitor AI usage costs, budget, and optimization opportunities"})]}),(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[{value:"7d",label:"7 Days"},{value:"30d",label:"30 Days"},{value:"90d",label:"90 Days"}].map(e=>(0,f.jsx)("button",{onClick:()=>{return t=e.value,g(t),void j({timeframe:t});var t},className:"px-3 py-1 rounded-md text-sm font-medium transition-colors ".concat(m===e.value?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"),children:e.label},e.value))}),(0,f.jsx)(E,{costData:A,historicalData:u,onExport:async e=>(console.log("Export requested:",e),new Promise(t=>{setTimeout(()=>{t({url:"blob:mock-export-url",filename:"cost-analytics-".concat((new Date).toISOString().split("T")[0],".").concat("excel"===e.format?"xlsx":e.format)})},2e3)}))})]})]}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,f.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0},className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Spend"}),(0,f.jsxs)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",A.total_cost.toFixed(2)]}),(0,f.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:A.timeframe})]}),(0,f.jsx)("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:(0,f.jsx)(d.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})})]})}),(0,f.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Monthly Projection"}),(0,f.jsxs)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",A.projected_monthly_cost.toFixed(2)]}),(0,f.jsxs)("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[P.monthly_limit>0?(P.projected_month_end_spend/P.monthly_limit*100).toFixed(1):0,"% of budget"]})]}),(0,f.jsx)("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:(0,f.jsx)(i.A,{className:"h-6 w-6 text-green-600 dark:text-green-400"})})]})}),(0,f.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Tokens"}),(0,f.jsxs)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[(A.token_usage.total_tokens/1e3).toFixed(0),"K"]}),(0,f.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[A.token_usage.total_tokens>0?(A.token_usage.output_tokens/A.token_usage.total_tokens*100).toFixed(0):0,"% output"]})]}),(0,f.jsx)("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:(0,f.jsx)(l.A,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})})]})}),(0,f.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Daily Average"}),(0,f.jsxs)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",u.length>0?(A.total_cost/u.length).toFixed(2):"0.00"]}),(0,f.jsx)("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"per day"})]}),(0,f.jsx)("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:(0,f.jsx)(n.A,{className:"h-6 w-6 text-orange-600 dark:text-orange-400"})})]})})]}),(0,f.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,f.jsx)("nav",{className:"-mb-px flex space-x-8",children:_.map(e=>{const t=e.icon;return(0,f.jsxs)("button",{onClick:()=>x(e.id),className:"group inline-flex items-center px-1 py-4 border-b-2 font-medium text-sm ".concat(a===e.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[(0,f.jsx)(t,{className:"mr-2 h-5 w-5 ".concat(a===e.id?"text-blue-500 dark:text-blue-400":"text-gray-400 group-hover:text-gray-500 dark:group-hover:text-gray-300")}),e.label]},e.id)})})}),(0,f.jsxs)(r.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3},className:"mt-6",children:["overview"===a&&(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,f.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Cost by Model"}),(0,f.jsx)("div",{className:"space-y-3",children:Object.entries(A.cost_by_model).map(e=>{let[t,a]=e;return(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-500 mr-3"}),(0,f.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t})]}),(0,f.jsxs)("div",{className:"text-right",children:[(0,f.jsxs)("p",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:["$",a.toFixed(2)]}),(0,f.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[A.total_cost>0?(a/A.total_cost*100).toFixed(1):0,"%"]})]})]},t)})})]}),(0,f.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Cost by Operation"}),(0,f.jsx)("div",{className:"space-y-3",children:Object.entries(A.cost_by_operation).map(e=>{let[t,a]=e;return(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500 mr-3"}),(0,f.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white capitalize",children:t})]}),(0,f.jsxs)("div",{className:"text-right",children:[(0,f.jsxs)("p",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:["$",a.toFixed(2)]}),(0,f.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[A.total_cost>0?(a/A.total_cost*100).toFixed(1):0,"%"]})]})]},t)})})]})]}),(0,f.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Recent Daily Costs"}),(0,f.jsx)("div",{className:"overflow-x-auto",children:(0,f.jsxs)("table",{className:"min-w-full",children:[(0,f.jsx)("thead",{children:(0,f.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,f.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 dark:text-white",children:"Date"}),(0,f.jsx)("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-900 dark:text-white",children:"Cost"}),(0,f.jsx)("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-900 dark:text-white",children:"Tokens"}),(0,f.jsx)("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-900 dark:text-white",children:"Requests"})]})}),(0,f.jsx)("tbody",{children:u.slice(-5).map((e,t)=>(0,f.jsxs)("tr",{className:"border-b border-gray-100 dark:border-gray-700",children:[(0,f.jsx)("td",{className:"py-3 px-4 text-sm text-gray-900 dark:text-white",children:new Date(e.date).toLocaleDateString()}),(0,f.jsxs)("td",{className:"py-3 px-4 text-sm font-medium text-gray-900 dark:text-white text-right",children:["$",e.cost.toFixed(2)]}),(0,f.jsx)("td",{className:"py-3 px-4 text-sm text-gray-600 dark:text-gray-400 text-right",children:e.tokens.toLocaleString()}),(0,f.jsx)("td",{className:"py-3 px-4 text-sm text-gray-600 dark:text-gray-400 text-right",children:e.requests})]},e.date))})]})})]})]}),"charts"===a&&(0,f.jsx)(k,{data:u,timeframe:m,className:"w-full"}),"budget"===a&&(0,f.jsx)(C,{budgetInfo:P,onUpdateBudget:v,className:"w-full"}),"projections"===a&&(0,f.jsx)(S,{historicalData:u,monthlyBudget:P.monthly_limit,className:"w-full"}),"recommendations"===a&&(0,f.jsx)(q,{costData:A,historicalData:u,onImplementRecommendation:async e=>(console.log("Implementing recommendation:",e),new Promise(e=>setTimeout(e,2e3))),className:"w-full"})]},a)]})},X=()=>(0,f.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,f.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,f.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-8",children:"Cost Analytics Dashboard"}),(0,f.jsx)(Y,{})]})})}}]);
//# sourceMappingURL=608.e8ef36b0.chunk.js.map